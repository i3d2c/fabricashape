<!DOCTYPE html>
<html>
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

        <title>Fabricshape Example 2D</title>
    </head>
    <body>
        <nav class="navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow">
            <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="#">Concept Constructif</a>
            <input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">
            <ul class="navbar-nav px-3">
                <li class="nav-item text-nowrap">
                    <a class="nav-link" href="#">Sign out</a>
                </li>
            </ul>
        </nav>

        <div class="container-fluid">
            <div class="row">
                <nav class="col-md-2 d-none d-md-block bg-light sidebar">
                    <div class="sidebar-sticky">
                        <ul class="nav flex-column">
                            <li class="nav-item input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon3">Echelle</span>
                                </div>
                                <input id="scaleValue" type="text" class="form-control" aria-label="size" onChange="updateScaleValue(this)">
                                <div class="input-group-append">
                                    <span class="input-group-text">m</span>
                                    <a class="input-group-text btn" onClick="addArrowLine({left: 50, top: 40, width: 200, height: 30, fill: 'blue'})">+</a>
                                </div>
                            </li>
                            <li class="nav-item">-</li>
                            <li class="nav-item input-group">
                                <select id="ouvrageSelect" class="form-control">
                                    <option value="Ouvrage1" style="background-color: red">Ouvrage 1</option>
                                    <option value="Ouvrage2" style="background-color: rgb(200,100,0)">Ouvrage 2</option>
                                </select>
                                <input type="text" class="form-control" aria-label="size">
                                <div class="input-group-append">
                                    <span class="input-group-text">m</span>
                                    <a class="input-group-text btn" onClick="addLine({left: 50, top: 40, width: 200, height: 30})">+</a>
                                </div>
                            </li>
                            <li class="nav-item">-</li>
                            <li class="nav-item">
                                <input class="form-control" type="file" id="imgLoader" onChange="addImage(event)">
                                    <a class="input-group-text btn" onClick="lockImage()">lock</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">
                                    <span data-feather="users"></span>
                                    Customers
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">
                                    <span data-feather="bar-chart-2"></span>
                                    Reports
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">
                                    <span data-feather="layers"></span>
                                    Integrations
                                </a>
                            </li>
                        </ul>

                        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                            <span>Saved reports</span>
                            <a class="d-flex align-items-center text-muted" href="#">
                                <span data-feather="plus-circle"></span>
                            </a>
                        </h6>
                        <ul class="nav flex-column mb-2">
                            <li class="nav-item">
                                <a class="nav-link" href="#">
                                    <span data-feather="file-text"></span>
                                    Current month
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">
                                    <span data-feather="file-text"></span>
                                    Last quarter
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">
                                    <span data-feather="file-text"></span>
                                    Social engagement
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">
                                    <span data-feather="file-text"></span>
                                    Year-end sale
                                </a>
                            </li>
                        </ul>
                    </div>
                </nav>

                <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Dashboard</h1>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div class="btn-group mr-2">
                            <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
                        </div>
                        <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
                            <span data-feather="calendar"></span>
                            This week
                        </button>
                    </div>
                </div>

                <canvas class="my-4 w-100" id="example2D" width="900" height="380" style="border: 1px solid rgb(170, 170, 170);"></canvas>

                <h2>Section title</h2>
                <div class="table-responsive">
                    <table class="table table-striped table-sm">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Header</th>
                                <th>Header</th>
                                <th>Header</th>
                                <th>Header</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1,001</td>
                                <td>Lorem</td>
                                <td>ipsum</td>
                                <td>dolor</td>
                                <td>sit</td>
                            </tr>
                            <tr>
                                <td>1,002</td>
                                <td>amet</td>
                                <td>consectetur</td>
                                <td>adipiscing</td>
                                <td>elit</td>
                            </tr>
                            <tr>
                                <td>1,003</td>
                                <td>Integer</td>
                                <td>nec</td>
                                <td>odio</td>
                                <td>Praesent</td>
                            </tr>
                            <tr>
                                <td>1,003</td>
                                <td>libero</td>
                                <td>Sed</td>
                                <td>cursus</td>
                                <td>ante</td>
                            </tr>
                            <tr>
                                <td>1,004</td>
                                <td>dapibus</td>
                                <td>diam</td>
                                <td>Sed</td>
                                <td>nisi</td>
                            </tr>
                            <tr>
                                <td>1,005</td>
                                <td>Nulla</td>
                                <td>quis</td>
                                <td>sem</td>
                                <td>at</td>
                            </tr>
                            <tr>
                                <td>1,006</td>
                                <td>nibh</td>
                                <td>elementum</td>
                                <td>imperdiet</td>
                                <td>Duis</td>
                            </tr>
                            <tr>
                                <td>1,007</td>
                                <td>sagittis</td>
                                <td>ipsum</td>
                                <td>Praesent</td>
                                <td>mauris</td>
                            </tr>
                            <tr>
                                <td>1,008</td>
                                <td>Fusce</td>
                                <td>nec</td>
                                <td>tellus</td>
                                <td>sed</td>
                            </tr>
                            <tr>
                                <td>1,009</td>
                                <td>augue</td>
                                <td>semper</td>
                                <td>porta</td>
                                <td>Mauris</td>
                            </tr>
                            <tr>
                                <td>1,010</td>
                                <td>massa</td>
                                <td>Vestibulum</td>
                                <td>lacinia</td>
                                <td>arcu</td>
                            </tr>
                            <tr>
                                <td>1,011</td>
                                <td>eget</td>
                                <td>nulla</td>
                                <td>Class</td>
                                <td>aptent</td>
                            </tr>
                            <tr>
                                <td>1,012</td>
                                <td>taciti</td>
                                <td>sociosqu</td>
                                <td>ad</td>
                                <td>litora</td>
                            </tr>
                            <tr>
                                <td>1,013</td>
                                <td>torquent</td>
                                <td>per</td>
                                <td>conubia</td>
                                <td>nostra</td>
                            </tr>
                            <tr>
                                <td>1,014</td>
                                <td>per</td>
                                <td>inceptos</td>
                                <td>himenaeos</td>
                                <td>Curabitur</td>
                            </tr>
                            <tr>
                                <td>1,015</td>
                                <td>sodales</td>
                                <td>ligula</td>
                                <td>in</td>
                                <td>libero</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                </main>
            </div>
        </div>

        <!-- Custom Javascript -->
        <script src="../dist/main.js"></script>
        <script type="text/javascript" charset="utf-8">
            var canvas = new fabricashape.Canvas('example2D', {class: "my-4 w-100"});
            // Handle resizing of the canvas
            const resizeCanvas = () => {
                const parentwidth = canvas.wrapperEl.parentElement.offsetWidth
                canvas.setWidth(parentwidth - 48) //48 to align it corectly. Naive fix.
                canvas.renderAll()
            }

            window.addEventListener('resize', resizeCanvas, false)

            resizeCanvas()

            function addLine(options) {
                const selectObject = document.getElementById("ouvrageSelect"),
                    selectedColor = selectObject.options[selectObject.selectedIndex].style.backgroundColor

                options["fill"] = selectedColor
                const line = new fabricashape.Line(options)
                canvas.add(line)
                line.setText("1")
                canvas.renderAll()
            }

            function addArrowLine(options) {
                const scaleValueObject = document.getElementById("scaleValue"),
                    scaleValue = scaleValueObject.value

                options["text"] = scaleValue
                const arrowline = new fabricashape.Arrowline(options)

                canvas.add(arrowline)
                canvas.setScale({shape: arrowline})
            }

            function updateScaleValue(item) {
                const arrowline = canvas.getScale().shape
                arrowline.setText(item.value)
                canvas.renderAll()
            }

            let image

            function addImage(e) {
                const input = e.target
                const reader = new FileReader()

                reader.onload = () => {
                    const img = document.createElement('img')
                    img.src = reader.result

                    image = new fabric.Image(img)
                    image.scale(canvas.height/image.height)
                    canvas.add(image)
                    canvas.renderAll()
                };

                reader.readAsDataURL(input.files[0]);
            }

            function lockImage() {
                image.hasControls = false
                image.selectable = false
                canvas.discardActiveObject();
                canvas.renderAll()
            }

        </script>

        <!-- Vendors: jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    </body>
    <style>

body {
    font-size: .875rem;
}

.feather {
    width: 16px;
    height: 16px;
    vertical-align: text-bottom;
}

/*
 * Sidebar
 */

.sidebar {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    z-index: 100; /* Behind the navbar */
    padding: 48px 0 0; /* Height of navbar */
    box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
}

.sidebar-sticky {
    position: relative;
    top: 0;
    height: calc(100vh - 48px);
    padding-top: .5rem;
    overflow-x: hidden;
    overflow-y: auto; /* Scrollable contents if viewport is shorter than content. */
}

  @supports ((position: -webkit-sticky) or (position: sticky)) {
      .sidebar-sticky {
          position: -webkit-sticky;
          position: sticky;
      }
  }

  .sidebar .nav-link {
      font-weight: 500;
      color: #333;
  }

  .sidebar .nav-link .feather {
      margin-right: 4px;
      color: #999;
  }

  .sidebar .nav-link.active {
      color: #007bff;
  }

  .sidebar .nav-link:hover .feather,
  .sidebar .nav-link.active .feather {
      color: inherit;
  }

  .sidebar-heading {
      font-size: .75rem;
      text-transform: uppercase;
  }

  /*
   * Content
   */

  [role="main"] {
      padding-top: 133px; /* Space for fixed navbar */
  }

  @media (min-width: 768px) {
      [role="main"] {
          padding-top: 48px; /* Space for fixed navbar */
      }
  }

  /*
   * Navbar
   */

  .navbar-brand {
      padding-top: .75rem;
      padding-bottom: .75rem;
      font-size: 1rem;
      background-color: rgba(0, 0, 0, .25);
      box-shadow: inset -1px 0 0 rgba(0, 0, 0, .25);
  }

  .navbar .form-control {
      padding: .75rem 1rem;
      border-width: 0;
      border-radius: 0;
  }

  .form-control-dark {
      color: #fff;
      background-color: rgba(255, 255, 255, .1);
      border-color: rgba(255, 255, 255, .1);
  }

  .form-control-dark:focus {
      border-color: transparent;
      box-shadow: 0 0 0 3px rgba(255, 255, 255, .25);
  }
    </style>
</html>
